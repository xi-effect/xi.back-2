paths:
# community-participation
  /!SUB!/user-room/create-community/:
    head:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Community.FullResponseSchema'
  /!PUB!/create-community/:
    trace:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                data:
                  $ref: '#/components/schemas/Community.FullInputSchema'
              required:
                - data
      responses:
        '200':
          description: Success
          headers:
            "Enter Room":
              description: "community-room"
              schema:
                type: string
            "Enter Room ":
              description: "participant-room"
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ParticipationModel'
  /!SUB!/user-room/join-community/:
    head:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Community.FullResponseSchema'
  /!PUB!/join-community/:
    trace:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
              required:
                - code
      responses:
        '200':
          description: Success
          headers:
            "Enter Room":
              description: "community-room"
              schema:
                type: string
            "Enter Room ":
              description: "participant-room"
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ParticipationModel'
        '404':
          description: Invitation not found
        '409':
          description: Already joined
          content:
            application/json:
              schema:
                type: string
                const: "Already joined"
                example: "Already joined"
  /!PUB!/test-join-community/:
    trace:
      deprecated: true
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '200':
          description: Success
          headers:
            "Enter Room":
              description: "community-room"
              schema:
                type: string
            "Enter Room ":
              description: "participant-room"
              schema:
                type: string
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ParticipationModel'
        '404':
          description: Community not found
        '409':
          description: Already joined
          content:
            application/json:
              schema:
                type: string
                const: "Already joined"
                example: "Already joined"
  /!SUB!/participant-room/kicked-from-community/:
    head:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
              - community_id
  /!SUB!/participant-room/update-participation/:
    head:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
                participant:
                  $ref: '#/components/schemas/Participant.CurrentSchema'
              required:
              - community_id
              - participant
  /!SUB!/participant-room/leave-community/:
    head:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
  /!PUB!/leave-community/:
    trace:
      tags:
        - community-participation
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '204':
          description: Success
          headers:
            "Leave Room":
              description: "community-room"
              schema:
                type: string
            "Close Room ":
              description: "participant-room"
              schema:
                type: string
            "Leave Room  ":
              description: "participants-list-room"
              schema:
                type: string
        '404':
          description: Community not found
        '403':
          description: No access to community
        '409':
          description: Owner can not leave
          content:
            application/json:
              schema:
                type: string
                const: "Owner can not leave"
                example: "Owner can not leave"
# communities-list
  /!PUB!/list-communities/:
    trace:
      tags:
        - communities-list
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Community.FullResponseSchema'
  /!PUB!/retrieve-community/:
    trace:
      tags:
        - communities-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '200':
          description: Success
          headers:
            "Enter Room":
              description: "community-room"
              schema:
                type: string
            "Enter Room ":
              description: "participant-room"
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ParticipationModel'
        '403':
          description: No access to community
        '404':
          description: Community not found
  /!PUB!/retrieve-any-community/:
    trace:
      tags:
        - communities-list
      responses:
        '200':
          description: Success
          headers:
            "Enter Room":
              description: "community-room"
              schema:
                type: string
            "Enter Room ":
              description: "participant-room"
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ParticipationModel'
        '404':
          description: Community not found
  /!PUB!/close-community/:
    trace:
      tags:
        - communities-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '204':
          description: Success
          headers:
            "Leave Room":
              description: "community-room"
              schema:
                type: string
            "Leave Room ":
              description: "participant-room"
              schema:
                type: string
            "Leave Room  ":
              description: "participants-list-room"
              schema:
                type: string
# community-meta-admin
  /!SUB!/community-room/update-community/:
    head:
      tags:
        - community-meta-admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Community.FullResponseSchema'
  /!PUB!/update-community/:
    trace:
      tags:
        - community-meta-admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
                data:
                  $ref: '#/components/schemas/Community.FullInputSchema'
              required:
                - community_id
                - data
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Community.FullResponseSchema'
        '403 ':
          description: No access to community
        '403  ':
          description: Not sufficient permissions
        '404 ':
          description: Community not found
  /!SUB!/community-room/delete-community/:
    head:
      tags:
        - community-meta-admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
  /!PUB!/delete-community/:
    trace:
      tags:
        - community-meta-admin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '204 ':
          description: Success
          headers:
            "Close Room":
              description: "community-room"
              schema:
                type: string
            "Close Room ":
              description: "participant-list-room"
              schema:
                type: string
        '404 ':
          description: Community not found
        '403 ':
          description: No access to community
        '403  ':
          description: Not sufficient permissions
# participants-list
  /!PUB!/list-participants/:
    trace:
      tags:
        - participants-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '200':
          description: Success
          headers:
            "Enter Room":
              description: "participants-list-room"
              schema:
                type: string
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Participant.ListItemSchema'
  /!SUB!/participants-list-room/create-participant/:
    head:
      tags:
        - participants-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
                participant:
                  $ref: '#/components/schemas/Participant.ListItemSchema'
              required:
              - community_id
              - participant
  /!SUB!/participants-list-room/delete-participant/:
    head:
      tags:
        - participants-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ParticipantIds'
  /!PUB!/kick-participant/:
    trace:
      tags:
        - participants-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ParticipantIds'
      responses:
        '204 ':
          description: Success
        '404 ':
          description: Community not found
        '404  ':
          description: Participant not found
        '403 ':
          description: No access to community
        '403  ':
          description: Not sufficient permissions
        '409 ':
          description: Owner can not be kicked
          content:
            application/json:
              schema:
                type: string
                const: "Owner can be kicked"
                example: "Owner can be kicked"
  /!SUB!/participants-list-room/update-participants/:
    head:
      tags:
        - participants-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
                participants:
                  type: array
                  items:
                    $ref: '#/components/schemas/Participant.ListItemSchema'
              required:
              - community_id
              - participants
  /!PUB!/transfer-ownership/:
    trace:
      tags:
        - participants-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ParticipantIds'
      responses:
        '204':
          description: Success
        '404 ':
          description: Community not found
        '404  ':
          description: Participant not found
        '403 ':
          description: No access to community
        '403  ':
          description: Not sufficient permissions
  /!PUB!/close-participants/:
    trace:
      tags:
        - participants-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '204':
          description: Success
          headers:
            "Leave Room":
              description: "participants-list-room"
              schema:
                type: string
# invitations-list
  /!PUB!/list-invitations/:
    trace:
      tags:
        - invitations-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
              required:
                - community_id
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Invitation.FullResponseSchema'
        '404 ':
          description: Community not found
        '404  ':
          description: Participant not found
        '403 ':
          description: No access to community
        '403  ':
          description: Not sufficient permissions
  /!PUB!/create-invitation/:
    trace:
      tags:
        - invitations-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
                data:
                  $ref: '#/components/schemas/Invitation.FullInputSchema'
              required:
                - community_id
                - data
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Invitation.FullResponseSchema'
        '404 ':
          description: Community not found
        '404  ':
          description: Participant not found
        '403 ':
          description: No access to community
        '403  ':
          description: Not sufficient permissions
        '409 ':
          description: Quantity exceeded
          content:
            application/json:
              schema:
                type: string
                const: "Quantity exceeded"
                example: "Quantity exceeded"
  /!PUB!/delete-invitation/:
    trace:
      tags:
        - invitations-list
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                community_id:
                  $ref: '#/components/schemas/CommunityId'
                invitation_id:
                  type: integer
              required:
              - community_id
              - invitation_id
      responses:
        '204 ':
          description: Success
        '404 ':
          description: "Community not found"
        '404  ':
          description: Participant not found
        '404   ':
          description: Invitation not found
        '403 ':
          description: No access to community
        '403  ':
          description: Not sufficient permissions
components:
  errors:
    CommunityNotFound:
      description: Community not found
      content:
        application/json:
          schema:
            type: string
            const: "Community not found"
            example: "Community not found"
    InvitationNotFound:
      description: Invitation not found
      content:
        application/json:
          schema:
            type: string
            const: "Invitation not found"
            example: "Invitation not found"
    NoAccessToCommunity:
      description: No access to community
      content:
        application/json:
          schema:
            type: string
            const: "No access to community"
            example: "No access to community"
    NotSufficientPermissions:
      description: Not sufficient permissions
      content:
        application/json:
          schema:
            type: string
            const: "Not sufficient permissions"
            example: "Not sufficient permissions"
    ParticipantNotFound:
      description: Participant not found
      content:
        application/json:
          schema:
            type: string
            const: "Participant not found"
            example: "Participant not found"
    TargetIsTheSource:
      description: Target is the source
      content:
        application/json:
          schema:
            type: string
            const: "Target is the source"
            example: "Target is the source"
  schemas:
    CommunityId:
      title: CommunityId
      type: integer
    UserId:
      title: UserId
      type: integer
    ParticipantIds:
      title: ParticipantIds
      type: object
      properties:
        community_id:
          $ref: '#/components/schemas/CommunityId'
        user_id:
          $ref: '#/components/schemas/UserId'
      required:
      - community_id
      - user_id
    Community.FullResponseSchema:
      properties:
        description:
          anyOf:
            - type: string
            - type: 'null'
          default: null
          title: Description
        id:
          title: Id
          type: integer
        name:
          maxLength: 100
          title: Name
          type: string
      required:
        - id
        - name
      title: Community.FullResponseSchema
      type: object
    Community.FullInputSchema:
      properties:
        description:
          anyOf:
          - type: string
          - type: 'null'
          default: null
          title: Description
        name:
          maxLength: 100
          title: Name
          type: string
      required:
       - name
      title: Community.FullInputSchema
      type: object
    Participant.ListItemSchema:
      properties:
        created_at:
          format: date-time
          title: Created At
          type: string
        is_owner:
          default: false
          title: Is Owner
          type: boolean
        user_id:
          title: User Id
          type: integer
      required:
      - id
      - user_id
      - created_at
      title: Participant.FullResponseSchema
      type: object
    Participant.CurrentSchema:
      properties:
        is_owner:
          default: false
          title: Is Owner
          type: boolean
      required:
      - id
      title: Participant.CurrentSchema
      type: object
    ParticipationModel:
      properties:
        community:
          $ref: '#/components/schemas/Community.FullResponseSchema'
        participant:
          $ref: '#/components/schemas/Participant.CurrentSchema'
      required:
      - community
      - participant
      title: ParticipationModel
      type: object
    Invitation.FullResponseSchema:
      properties:
        expiry:
          anyOf:
            - format: date-time
              type: string
            - type: 'null'
          default: null
          title: Expiry
        id:
          title: Id
          type: integer
        token:
          maxLength: 50
          title: Token
          type: string
        usage_count:
          default: 0
          title: Usage Count
          type: integer
        usage_limit:
          anyOf:
            - exclusiveMinimum: 0
              type: integer
            - type: 'null'
          default: null
          title: Usage Limit
      required:
        - id
        - token
      title: Invitation.FullResponseSchema
      type: object
  Invitation.FullInputSchema:
    properties:
      expiry:
        anyOf:
          - format: date-time
            type: string
          - type: 'null'
        default: null
        title: Expiry
      usage_limit:
        anyOf:
          - exclusiveMinimum: 0
            type: integer
          - type: 'null'
        default: null
        title: Usage Limit
    title: Invitation.FullInputSchema
    type: object
